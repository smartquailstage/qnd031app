{% extends "base_dash.html" %}
{% load widget_tweaks %}
{% load static %}







{% block content %}
<!-- En tu base.html dentro de <head> -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  .table-hover tbody tr:hover {
    background-color: #18bb6b; /* Color de fondo al pasar el mouse */
    cursor: pointer; /* Opcional: muestra el cursor como puntero */
  }
</style>

<div class="page-content-wrapper">
    <!-- start page content-->
   <div class="page-content">


          <div class="card">
            <div class="card-body">
              <div class="d-flex align-items-center">
            <h3> {{ total }} <ion-icon name="notifications"></ion-icon> /  {{ leidos }} <ion-icon name="mail-open"></ion-icon>  / {{ no_leidos }} <ion-icon name="mail-unread"></ion-icon></h3>
          
            <hr/>
              </div>
              <h2 class="mb-4">Mis Citas</h2>
              
              <div class="mb-3">
                <span class="badge bg-success">Confirmadas: {{ citas_confirmadas }}</span>
                <span class="badge bg-warning text-dark">Pendientes: {{ citas_pendientes }}</span>
                <span class="badge bg-danger">Canceladas: {{ citas_canceladas }}</span>
              </div>
            
              <table class="table-responsive mt-3">
                <thead>
                  <tr>
                    <th>Fecha</th>
                    <th>Hora</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody>
                  {% for cita in citas %}
                  <tr>
                    <td>{{ cita.fecha|date:"j/n/Y" }} / {{ cita.hora|time:"H:i" }}</td>
                   
                    <td>
                      <span class="badge 
                        {% if cita.estado == 'confirmada' %}bg-success
                        {% elif cita.estado == 'pendiente' %}bg-warning text-dark
                        {% elif cita.estado == 'cancelada' %}bg-danger
                        {% endif %}">
                        {{ cita.estado|capfirst }}
                      </span>
                    </td>
                    <td>
                      <a href="{% url 'usuarios:editar_cita' cita.id %}" class="btn btn-sm btn-primary">Editar</a>
                      <a href="{% url 'usuarios:cancelar_cita' cita.id %}" class="btn btn-sm btn-danger">Cancelar</a>
                    </td>
                  </tr>
                  {% empty %}
                  <tr>
                    <td colspan="4">No tienes citas registradas.</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>




            </div>
          </div>

          <div class="container mt-4">
            <h2 class="mb-4">Mis Citas</h2>
        
            <!-- Estadísticas rápidas -->
            <div class="row text-center mb-4">
                <div class="col-md-4">
                    <div class="card text-white bg-success">
                        <div class="card-body">
                            <h5>Confirmadas</h5>
                            <p>{{ citas_confirmadas }}</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card text-white bg-warning">
                        <div class="card-body">
                            <h5>Pendientes</h5>
                            <p>{{ citas_pendientes }}</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card text-white bg-danger">
                        <div class="card-body">
                            <h5>Canceladas</h5>
                            <p>{{ citas_canceladas }}</p>
                        </div>
                    </div>
                </div>
            </div>
        
            <!-- Calendario / Lista de Citas -->
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead class="thead-light">
                        <tr>
                            <th>Fecha</th>
                            <th>Descripción</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for cita in citas %}
                            <tr class="{% if cita.estado == 'cancelada' %}table-danger{% elif cita.estado == 'pendiente' %}table-warning{% else %}table-success{% endif %}">
                                <td>{{ cita.fecha|date:"d M Y H:i" }}</td>
                                <td>{{ cita.descripcion }}</td>
                                <td>{{ cita.estado|title }}</td>
                                <td>
                                    {% if cita.estado != 'cancelada' %}
                                        <a href="{% url 'editar_cita' cita.id %}" class="btn btn-sm btn-primary">Editar</a>
                                        <a href="{% url 'cancelar_cita' cita.id %}" class="btn btn-sm btn-danger" onclick="return confirm('¿Estás seguro de cancelar esta cita?');">Cancelar</a>
                                    {% else %}
                                        <span class="text-muted">Sin acciones</span>
                                    {% endif %}
                                </td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td colspan="4" class="text-center">No tienes citas programadas.</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div><div class="container mt-4">
          <h2 class="mb-4">Mis Citas</h2>
      
          <!-- Estadísticas rápidas -->
          <div class="row text-center mb-4">
              <div class="col-md-4">
                  <div class="card text-white bg-success">
                      <div class="card-body">
                          <h5>Confirmadas</h5>
                          <p>{{ citas_confirmadas }}</p>
                      </div>
                  </div>
              </div>
              <div class="col-md-4">
                  <div class="card text-white bg-warning">
                      <div class="card-body">
                          <h5>Pendientes</h5>
                          <p>{{ citas_pendientes }}</p>
                      </div>
                  </div>
              </div>
              <div class="col-md-4">
                  <div class="card text-white bg-danger">
                      <div class="card-body">
                          <h5>Canceladas</h5>
                          <p>{{ citas_canceladas }}</p>
                      </div>
                  </div>
              </div>
          </div>
      
          <!-- Calendario / Lista de Citas -->
          <div class="table-responsive">
              <table class="table table-hover">
                  <thead class="thead-light">
                      <tr>
                          <th>Fecha</th>
                          <th>Descripción</th>
                          <th>Estado</th>
                          <th>Acciones</th>
                      </tr>
                  </thead>
                  <tbody>
                      {% for cita in citas %}
                          <tr class="{% if cita.estado == 'cancelada' %}table-danger{% elif cita.estado == 'pendiente' %}table-warning{% else %}table-success{% endif %}">
                              <td>{{ cita.fecha|date:"d M Y H:i" }}</td>
                              <td>{{ cita.descripcion }}</td>
                              <td>{{ cita.estado|title }}</td>
                              <td>
                                  {% if cita.estado != 'cancelada' %}
                                      <a href="{% url 'editar_cita' cita.id %}" class="btn btn-sm btn-primary">Editar</a>
                                      <a href="{% url 'cancelar_cita' cita.id %}" class="btn btn-sm btn-danger" onclick="return confirm('¿Estás seguro de cancelar esta cita?');">Cancelar</a>
                                  {% else %}
                                      <span class="text-muted">Sin acciones</span>
                                  {% endif %}
                              </td>
                          </tr>
                      {% empty %}
                          <tr>
                              <td colspan="4" class="text-center">No tienes citas programadas.</td>
                          </tr>
                      {% endfor %}
                  </tbody>
              </table>
          </div>
      </div>

        </div>
</div>  




{% endblock %}





<div class="container my-5">
  <h2 class="mb-4">Mis Citas</h2>

  <div class="mb-3">
    <span class="badge bg-success">Confirmadas: {{ citas_confirmadas }}</span>
    <span class="badge bg-warning text-dark">Pendientes: {{ citas_pendientes }}</span>
    <span class="badge bg-danger">Canceladas: {{ citas_canceladas }}</span>
  </div>

  <table class="table table-striped">
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Hora</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for cita in citas %}
      <tr>
        <td>{{ cita.fecha|date:"j/n/Y" }}</td>
        <td>{{ cita.hora|time:"H:i" }}</td>
        <td>
          <span class="badge 
            {% if cita.estado == 'confirmada' %}bg-success
            {% elif cita.estado == 'pendiente' %}bg-warning text-dark
            {% elif cita.estado == 'cancelada' %}bg-danger
            {% endif %}">
            {{ cita.estado|capfirst }}
          </span>
        </td>
        <td>
          <a href="{% url 'editar_cita' cita.id %}" class="btn btn-sm btn-primary">Editar</a>
          <a href="{% url 'cancelar_cita' cita.id %}" class="btn btn-sm btn-danger">Cancelar</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="4">No tienes citas registradas.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<style>
  .table-hover tbody tr:hover {
    background-color: #18bb6b; /* Color de fondo al pasar el mouse */
    cursor: pointer; /* Opcional: muestra el cursor como puntero */
  }
</style>

<div class="page-content-wrapper">
    <!-- start page content-->
   <div class="page-content">


          <div class="card">
            <div class="card-body">
              <div class="d-flex align-items-center">
            <h3><ion-icon name="notifications"></ion-icon> Notificaciones</h3>
            <hr/>

            <div class="app-citas module">
              <div class="module">
                <h1 class="text-2xl font-bold mb-4">Calendario de Citas</h1>
          
                <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.4/index.global.min.css" rel="stylesheet">
                <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.4/index.global.min.js"></script>
          
                <div id="calendar"></div>
          
                <script>
                  document.addEventListener('DOMContentLoaded', function() {
                    const calendarEl = document.getElementById('calendar');
                    const calendar = new FullCalendar.Calendar(calendarEl, {
                      initialView: 'dayGridMonth',
                      locale: 'es',
                      events: {{ events|safe }}
                    });
                    calendar.render();
                  });
                </script>
          
                <style>
                  #calendar {
                    max-width: 100%;
                    margin: 40px auto;
                  }
                </style>
              </div>
            </div>
            
            </div>
          </div>
        </div>
