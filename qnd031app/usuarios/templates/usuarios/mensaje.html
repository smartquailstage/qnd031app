{% extends "base_dash.html" %}
{% load widget_tweaks %}
{% load static %}

{% block content %}

        <div class="page-content-wrapper">
          <!-- start page content-->
            <div class="page-content">

        <!-- Primera fila fuera del contenedor -->
        <div class="row">
            <div class="col-12 col-lg-8 col-xl-12">
                <div class="card overflow-hidden radius-10">
                    <div class="profile-cover-4 bg-dark position-relative mb-4">
                        <!-- Logo arriba a la derecha -->


                        <!-- Avatar centrado -->
                        <div class="user-profile-avatar position-absolute top-50 start-0 translate-middle-x">
                      
                                <img src="{% static 'assets/meddes/notificaciones_avatar.png' %}" alt="User Photo">
                    
                        </div>
                    </div>

    <div class="card-body text-left">
       


<div class="col-12 col-md-6 mx-auto">
  <div class="card mb-4">
    <div class="card-body">
      <h2 class="font-weight-bold display-4" style="color:#45a851;">NOTIFICACIONES</h2>

      <h4 class="mb-4">{{ mensaje.asunto_2 }}</h4>

      <!-- Asunto y tipo -->
      <div class="mb-3">
        <h5 class="mb-1">
          Asunto: 
          {% if mensaje.asunto in 'consulta Sugerencia Informativo' %}
            <span class="badge bg-success">Informativo</span>
          {% elif mensaje.asunto == 'Terapéutico' %}
            <span class="badge bg-warning">Terapéutico</span>
          {% elif mensaje.asunto in 'Solicitud de pago vencido Solicitud de Certificado Médico Reclamo del servicio  Médico Cancelación del servicio Médico' %}
            <span class="badge bg-danger">Urgente</span>
          {% else %}
            <span class="badge bg-secondary">Otro</span>
          {% endif %}
        </h5>

        <!-- Fecha de envío (si aplica) -->
        {% if mensaje.fecha_envio %}
          <h6 class="text-muted">Enviado: {{ mensaje.fecha_envio }}</h6>
        {% endif %}
      </div>


      <!-- Estado de lectura -->
      <h6 class="mb-3">
        {% if mensaje.leido %}
          Leído <ion-icon name="eye-outline"></ion-icon>
        {% else %}
          Nuevo <ion-icon name="eye-off-outline"></ion-icon>
        {% endif %}
      </h6>

      <!-- Cuerpo del mensaje -->
      <p>{{ mensaje.cuerpo|safe }}</p>

      <!-- Descarga del archivo -->
      <ul class="list-group list-group-flush mt-3">
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <ion-icon name="attach-outline"></ion-icon>
            <strong>Archivo adjunto:</strong>
          </div>

          {% if mensaje.adjunto %}
            <a 
              class="btn btn-sm btn-outline-primary"
              href="{{ mensaje.adjunto.url }}"
              download
            >
              Descargar
            </a>
          {% else %}
            <span class="text-muted">No hay archivo adjunto</span>
          {% endif %}
        </li>
      </ul>

    </div>
  </div>
</div>

</div>

    </div>


                </div>
            </div> <!-- col -->
        </div> <!-- row -->

        <!-- Segunda fila dentro de un card y container -->


</div>


{% endblock %}


<div class="page-content-wrapper">
    <!-- start page content -->
    <div class="page-content">
   
  <div class="row">

         {% include 'usuarios/barra_herramientas.html' %} 


    </div> <!-- Fin row -->
    
    <div class="row">
            <!-- Sección de mensajes -->
               <div class="col-12 col-md-6 col-lg-9">
    <div class="card radius-10 bg-yellow">
            <div class="card-body">

                           
                 <h5 class="mb-0">                 
                    {% if mensaje.asunto == 'consulta' or mensaje.asunto == 'Sugerencia' or mensaje.asunto == 'Informativo' %}
                      Asunto: <span class="badge bg-success">Informativo</span>
                    {% elif mensaje.asunto == 'Terapéutico' %}  
                      Asunto: <span class="badge bg-warning">Terapéutico</span>
                      <h6> Enviado: {{ mensaje.fecha_envio }}</h6> 
                     
                    {% elif mensaje.asunto == 'Solicitud de pago vencido' or mensaje.asunto == 'Solicitud de Certificado Médico' or mensaje.asunto == 'Reclamo del servicio  Médico'  or mensaje.asunto == 'Cancelación del servicio Médico'  %}
                      Asunto: <span class="badge bg-danger">Urgente</span>
                    {% endif %}
                  </h5>
                  <h6 class="mb-0">{{ mensaje.emisor.first_name }} {{ mensaje.emisor.last_name }}</h6>
                  <p class="mb-0" >Grupo MEDDES®</p>
                  {% if mensaje.leido == True %}  
                      <h6>Leído <ion-icon name="eye-outline"></ion-icon></h6>
                    {% else %}
                      <h6>Nuevo <ion-icon name="eye-off-outline"></ion-icon></h6>
                    {% endif %} 
            </div>
    </div>
        <div class="card radius-10 bg-yellow">
            <div class="card-body">
                <h5 class="mb-0"><ion-icon name="notifications-sharp"></ion-icon> Notificación</h5>
                <p>{{ mensaje.cuerpo|safe }}</p>
            </div>
    </div>
    </div>

             {% include 'usuarios/panel_usuario.html' %} 

    </div> <!-- Fin row -->

        
    </div> <!-- Fin page-content -->
</div> <!-- Fin page-content-wrapper -->